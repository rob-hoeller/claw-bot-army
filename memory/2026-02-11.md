# Memory: 2026-02-11

## Session Summary

Long session with Lance building the HBx Dashboard chat interface.

## Key Work Completed

### 1. Chat Interface (Phase 1)
- Built chat UI components: ChatPanel, MessageBubble, ChatInput
- Features: typing indicator, file attachments, image paste, lightbox preview
- Agent Control Panel: tabbed interface (Chat | Files | Status | Cron | Memory)
- Full page modal (replaced side panel for more room)
- User channel selector (LM, RL, RH bubbles)
- Demo mode when Supabase not connected

### 2. Supabase Schema
- Created `conversations` and `messages` tables
- Lance ran SQL in Supabase editor
- RLS policies for user access
- Schema file: `/supabase/migrations/001_chat_schema.sql`

### 3. Global Knowledge Additions
- `/global-knowledge/CODE-FACTORY.md` — Full constitution for agent swarm
- `/global-knowledge/COORDINATION.md` — Protocol for HBx + human dev collaboration
- Added CODE-FACTORY to dashboard Global Knowledge panel

### 4. Shared Components Created
- `EmptyState.tsx`, `ErrorBanner.tsx`, `Skeletons.tsx`
- Required by Code Factory Constitution before scaling agents

## PRs
- PR #10: Merged (Agents page, Global Knowledge, UI fixes)
- PR #11: Merged (Dashboard name changes by Rob H)
- PR #12: Merged (Coordination protocol)
- PR #13: Closed (Chat interface - reviewing via Vercel preview first)

## Current Branch
`hbx/chat-interface` — Chat UI + Agent Control Panel
Preview: https://claw-bot-army-git-hbx-chat-interface-heartbeat-v2.vercel.app

## Workflow Established
1. Push to feature branch
2. Provide summary + what to test + Vercel link
3. NO PR until Lance authorizes
4. Iterate on feedback
5. PR only when Lance says "submit PR"

## Architecture Decisions
- **Option B (Hybrid)** for file persistence: Dashboard → Gateway API → Workspace files → periodic git sync
- **Supabase** for message storage
- Each agent gets own chat, each user has own channel, admins see all

## Next Steps (Phase 2+)
- Connect chat to OpenClaw gateway for real responses
- File upload to Supabase Storage
- Status/Cron/Memory tabs with real data
- Gateway auth integration

## Technical Notes
- Demo mode triggers when userId is not valid UUID
- `min-h-0` required on nested flex containers for proper height
- MEMORY.md removed from Files tab (has own Memory tab)
