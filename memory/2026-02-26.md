# Daily Memory — 2026-02-26

## Claude Code Agent Teams Integration

### What Was Done
- Installed Claude Code CLI v2.1.59 globally via `npm install -g @anthropic-ai/claude-code`
- Created `~/.claude/settings.json` with agent teams flag enabled and API key
- Added `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1` to `.bashrc` for shell sessions
- Installed `claude-code-teams` skill from ClawHub (v1.0.0 by matthew-a-gordon)
- Validated setup: CLI ✅, tmux ✅, env var ✅, templates ✅
- 6 workflow templates available: parallel-review, competing-hypotheses, fullstack-feature, architecture-decision, bottleneck-analysis, inventory-classification

### Architecture Change
- **Before:** HBx uses `sessions_spawn` for sequential hub-and-spoke delegation
- **After:** Can now also use Claude Code Agent Teams for parallel collaborative execution
- Both modes coexist — sessions_spawn for async background tasks, agent teams for intensive parallel work
- Teams require interactive PTY (SSH in, run `claude --teammate-mode tmux`)

### Integration Status
- Claude Code CLI: ✅ installed
- Settings + env var: ✅ configured
- Skill + templates: ✅ installed
- OpenClaw `coding-agent` skill: ✅ ready
- First team spawn: ⏳ pending — needs interactive SSH session to launch

### VPS Hardening — COMPLETED
- ✅ UFW firewall enabled: default deny incoming, allow outgoing
- ✅ SSH restricted to Tailscale interface only (`allow in on tailscale0 to any port 22`)
- ✅ All Tailscale traffic allowed (`allow in on tailscale0`)
- ✅ Port 8090 (hbx-monitoring.service) blocked from public internet (behind UFW)
- ✅ OpenClaw gateway on loopback — unaffected by firewall
- ⚠️ Tailscale Funnel still enabled (OpenClaw audit still flags as CRITICAL)
- ⚠️ Gateway password in config file (not env var)
- ⚠️ OpenClaw update available: 2026.2.24

### Parallel Agent Execution — VALIDATED
- `claude -p` mode works with ANTHROPIC_API_KEY env var (no OAuth needed)
- Two Sonnet agents ran in parallel successfully (Product Architect + QA Engineer)
- Both reviewed Header.tsx and found overlapping + complementary issues
- Pattern: `claude -p "task" --model sonnet --output-format text` in background exec
- Limitation: No inter-agent messaging in -p mode (need --teammate-mode tmux + OAuth for that)

### Pending
- One-time OAuth for full interactive team mode (--teammate-mode tmux) — Rob helping
- OpenClaw update to 2026.2.24 — Rob helping
- ✅ Tailscale Funnel → Serve (completed, 0 critical findings now)

### Next Major Initiative: Full HBx Codebase Audit & Refactor
Lance requested a comprehensive team review of the entire HBx dashboard codebase once agent teams are fully connected. Scope:
- Full code quality audit (all 121 files in dashboard/src)
- Fix inefficiencies, dead code, inconsistent patterns
- Improve performance, accessibility, type safety
- PRESERVE what works well — especially the agent detail panel with chat (Lance likes it)
- Multi-agent parallel review: IN1 (architecture), IN2 (code quality), IN6 (QA/edge cases)
- Then targeted refactoring sprints per finding
- Gate: agent team OAuth must be complete first for full inter-agent coordination

---

## Feature Shipped: Live Pipeline View + Active Workflows Board

### PR #88 — Merged 2026-02-26 13:14 UTC
- Branch: `feat/live-pipeline-workflows`
- 29 files changed, +6,158 lines
- Merged by Rob Hoeller

### Components Built (8 new files)
- `pipeline.types.ts` — 263 lines of type contracts (IN1 designed)
- `pipeline-utils.ts` — derivePipelineSteps() + helpers
- `LivePipelineView.tsx` — Animated 6-step horizontal pipeline (Framer Motion)
- `PipelineTerminal.tsx` — Terminal-style log viewer with macOS chrome
- `ActiveWorkflowsBoard.tsx` — Multi-workflow overview board
- `WorkflowCard.tsx` — Compact workflow card with click-to-expand terminal
- `DESIGN-pipeline-ui-polish.md` — 36KB design spec from IN5
- `FEATURE-live-pipeline-workflows.md` — Feature spec

### Integration
- ActiveWorkflowsBoard added to Dashboard.tsx (Command Center)
- LivePipelineView added to FeatureBoard.tsx (feature detail panel)

### DB Migration Applied
- Added `current_agent TEXT`, `pipeline_log JSONB`, `revision_count INTEGER` to features table
- 3 demo features seeded (Pipeline Animation Demo, Agent Chat Panel Improvements, VPS Security Dashboard Widget)

### UI Polish (8 improvements via IN5 → IN2 handoff)
1. Unique Lucide step icons (Inbox/FileText/Palette/Hammer/FlaskConical/Rocket)
2. Enhanced 3-layer running spinner animation
3. Thicker colored connector lines (green/amber-gradient/gray-dotted)
4. Larger status labels with color coding
5. 40px step circles (up from 32px), more card padding
6. Elapsed time display under each step
7. Priority badges (urgent/high/medium/low)
8. Click-to-expand inline terminal log

### QA Results
- 7 blocking issues found and fixed (accessibility + logic bugs)
- 6 warnings addressed (UX polish)
- All fixes verified: TypeScript clean, ESLint clean, Next.js build passes

### Agent Pipeline for This Feature
IN1 (types) → IN2 (build 5 components) → IN2 (integration) → IN6 (QA review) → IN2 (13 fixes) → IN5 (design spec) → IN2 (UI polish) → HBx (commit/PR) → Rob (merge)
Total agent spawns: 7 | Total build time: ~25 min across all agents

### VPS Hardening Completed (same session)
- UFW firewall: deny-by-default, SSH via Tailscale only
- Tailscale mode: funnel → serve (0 critical findings)
- Port 8090 blocked from public internet
- OpenClaw security audit: 0 critical, 2 warn, 3 info

### Session Learnings
- Claude Code CLI `-p` mode works for parallel agent execution on headless VPS (no OAuth needed)
- `--teammate-mode tmux` requires one-time OAuth via browser (pending)
- sessions_spawn is reliable for async agent delegation from OpenClaw
- IN5 → IN2 design handoff pattern works well (spec doc as contract)
- QA (IN6) found real bugs that would have shipped without review
